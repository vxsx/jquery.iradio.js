(function(a){a.fn.iradio=function(b){var c=a.extend({duration:500,draggable:!0,vertical:!1},b);if(!a.ui||!a.ui.draggable)c.draggable=!1;var d=a(this).hide(),e=d.map(function(b,c){return a('label[for="'+a(c).attr("id")+'"]').selector}).get().join(", ");a(d.selector+", "+e).wrapAll('<div class="iradio-wrap'+(c.vertical?" iradio-vertical":"")+'"></div>');var f=d.parent().append('<div class="knob"></div>'),g=a(".knob",f).append("<span>"+a('label[for="'+d.filter(":checked").attr("id")+'"]').text()+"</span>"),h=a("span",g),i=a("label",f),j=Math.max.apply(i,a(i).map(function(b,c){return a(c).width()}).get()),k=d.length;i.width(j),g.width(j);var l=f.width(),m=f.height(),n=c.vertical?m/k:l/k;for(var o=0;o<i.length;o++)a(i[o]).data("step",o);var p=a('label[for="'+a(":checked",f).attr("id")+'"]');d.change(function(){var b=a('label[for="'+a(this).attr("id")+'"]'),d=b.text(),e=c.duration*Math.abs(p.data("step")-b.data("step"))/k;p=b,g.is(":animated")&&(g.stop(),h.stop()),c.vertical?g.animate({top:b.position().top},e,"linear"):g.animate({left:b.position().left},e,"linear"),h.animate({opacity:"0.2"},e/2,"linear",function(){a(this).text(d).animate({opacity:"1"},e/2,"linear")})});var q=c.vertical?g.height():g.width(),r=c.vertical?"top":"left";c.draggable&&g.draggable({containment:"parent",axis:c.vertical?"y":"x",drag:function(b,c){var d=parseInt((c.position[r]+q/2)/n),e=a(i).eq(d).text();h.text()!=e&&h.animate({opacity:"0.2"},25,"linear",function(){a(this).text(e).animate({opacity:"1"},25,"linear")})},stop:function(b,e){var f=parseInt((e.position[r]+q/2)/n);c.vertical?g.animate({top:f*n},200,"linear"):g.animate({left:f*n},200,"linear"),a(d[f]).trigger("change")}});return this}})(jQuery)
